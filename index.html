

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Example &mdash; topkappy 0.2.3 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/main.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Topkappy - Reference manual" href="ref.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home" alt="Documentation Home"> topkappy
          

          
          </a>

          
            
            
              <div class="version">
                0.2.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Example</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="ref.html">Topkappy - Reference manual</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">topkappy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
        
      <li>Example</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <p align="center">
<img alt="Topkappy Logo" title="Topkappy Logo"
src="https://raw.githubusercontent.com/Edinburgh-Genome-Foundry/topkappy/master/docs/_static/images/title.png" width="600">
<br /><br />
</p><a class="reference external image-reference" href="https://travis-ci.org/Edinburgh-Genome-Foundry/topkappy"><img alt="Travis CI build status" src="https://travis-ci.org/Edinburgh-Genome-Foundry/topkappy.svg?branch=master" /></a>
<a class="reference external image-reference" href="https://coveralls.io/github/Edinburgh-Genome-Foundry/topkappy?branch=master"><img alt="https://coveralls.io/repos/github/Edinburgh-Genome-Foundry/topkappy/badge.svg?branch=master" src="https://coveralls.io/repos/github/Edinburgh-Genome-Foundry/topkappy/badge.svg?branch=master" /></a>
<p>Topkappy is a Python library for using the Kappa biological modeling system.
It is built on top of <code class="docutils literal notranslate"><span class="pre">kappy</span></code>, the official Python binding for Kappa, and
provides a more <em>pythonic</em> interface to define models and analyse results:
Python objects to define agents and rules, methods for visualizing complexes and
plotting time series, pretty error printing, etc.</p>
<div class="section" id="example">
<h1>Example<a class="headerlink" href="#example" title="Permalink to this headline">Â¶</a></h1>
<p>Here is a standard Kappa script defining a situation with 3 agents A, B, C which
can irreversibly bind together to form A-B-C chains. We end the simulation after
10 (virtual) seconds and take a snapshot.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>%agent: A(a, b)
%agent: B(b, c)
%agent: C(c, d)

&#39;a.b&#39; A(b[.]),B(b[.]) -&gt; A(b[1]),B(b[1]) @ 0.005
&#39;b.c&#39; B(c[.]),C(c[.]) -&gt; B(c[1]),C(c[1]) @ 0.021

%init: 100 A()
%init: 100 B()
%init: 100 C()

%mod: alarm 10.000 do $SNAPSHOT &quot;end&quot;;

%plot: |B(b[.])|
%plot: |C(c[.])|
</pre></div>
</div>
<p>Now here is the same model defined in Python with Topkappy:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">topkappy</span> <span class="kn">import</span> <span class="n">KappaModel</span><span class="p">,</span> <span class="n">KappaAgent</span><span class="p">,</span> <span class="n">KappaRule</span><span class="p">,</span> <span class="n">KappaSiteState</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">KappaModel</span><span class="p">(</span>
    <span class="n">agents</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">KappaAgent</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">)),</span>
        <span class="n">KappaAgent</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">)),</span>
        <span class="n">KappaAgent</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">))</span>
    <span class="p">],</span>
    <span class="n">rules</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">KappaRule</span><span class="p">(</span>
            <span class="s1">&#39;a.b&#39;</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="n">KappaSiteState</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">),</span>
                <span class="n">KappaSiteState</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
            <span class="p">],</span>
            <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="n">KappaSiteState</span><span class="p">(</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">),</span>
                <span class="n">KappaSiteState</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span>
            <span class="p">],</span>
            <span class="n">rate</span><span class="o">=</span><span class="mf">0.5e-2</span>
        <span class="p">),</span>
        <span class="n">KappaRule</span><span class="p">(</span>
            <span class="s1">&#39;b.c&#39;</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="n">KappaSiteState</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">),</span>
                <span class="n">KappaSiteState</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
            <span class="p">],</span>
            <span class="s1">&#39;-&gt;&#39;</span><span class="p">,</span>
            <span class="p">[</span>
                <span class="n">KappaSiteState</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">),</span>
                <span class="n">KappaSiteState</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span>
            <span class="p">],</span>
            <span class="n">rate</span><span class="o">=</span><span class="mf">2.1e-2</span>
        <span class="p">)</span>
    <span class="p">],</span>
    <span class="n">initial_quantities</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="n">duration</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
    <span class="n">snapshot_times</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;end&#39;</span><span class="p">:</span> <span class="mi">10</span>
    <span class="p">},</span>
    <span class="n">plots</span><span class="o">=</span><span class="p">[</span><span class="n">KappaSiteState</span><span class="p">(</span><span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">),</span>
           <span class="n">KappaSiteState</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">)]</span>
<span class="p">)</span>

<span class="c1"># Now simulate the model !</span>
<span class="n">simulation_results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_simulation_results</span><span class="p">()</span>
</pre></div>
</div>
<p>The Python version is admittedly longer than the original Kappa script, but
where Python shines is in its ability to programmatically define much more
complex and dynamic models with dozens of agents and rules.</p>
<p>Topkappy also makes it easy to simulate the result and get the final data, and
provide a few utilities to vizualize the results. For instance let us plot
the two time series records during the simulation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">topkappy</span> <span class="kn">import</span> <span class="n">plot_simulation_time_series</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plot_simulation_time_series</span><span class="p">(</span><span class="n">simulation_results</span><span class="p">[</span><span class="s1">&#39;plots&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;basic_example_time_series.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p align="center">
<img src="https://raw.githubusercontent.com/Edinburgh-Genome-Foundry/topkappy/master/examples/basic_example_time_series.png" width="640">
</p><p>And here is how you plot the products present at the end of the simulation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">end_agents</span> <span class="o">=</span> <span class="n">simulation_results</span><span class="p">[</span><span class="s1">&#39;snapshots&#39;</span><span class="p">][</span><span class="s1">&#39;end&#39;</span><span class="p">][</span><span class="s1">&#39;snapshot_agents&#39;</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plot_snapshot_agents</span><span class="p">(</span><span class="n">end_agents</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;basic_example_agents_graphs.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p align="center">
<img src="https://raw.githubusercontent.com/Edinburgh-Genome-Foundry/topkappy/master/examples/basic_example_agents_graphs.png" width="640">
</p></div>
<div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">Â¶</a></h1>
<p>You can install topkappy through PIP:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">topkappy</span>
</pre></div>
</div>
<p>Alternatively, you can unzip the sources in a folder and type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
</div>
<div class="section" id="license-mit">
<h1>License = MIT<a class="headerlink" href="#license-mit" title="Permalink to this headline">Â¶</a></h1>
<p>Topkappy is an open-source software originally written at the <a class="reference external" href="http://genomefoundry.org">Edinburgh Genome Foundry</a> by <a class="reference external" href="https://github.com/Zulko">Zulko</a> and <a class="reference external" href="https://github.com/Edinburgh-Genome-Foundry/topkappy">released on Github</a> under the MIT licence (Copyright 2018 Edinburgh Genome Foundry).</p>
<p>Everyone is welcome to contribute!</p>
</div>
<div class="section" id="more-biology-software">
<h1>More biology software<a class="headerlink" href="#more-biology-software" title="Permalink to this headline">Â¶</a></h1>
<a class="reference external image-reference" href="https://edinburgh-genome-foundry.github.io/"><img alt="https://raw.githubusercontent.com/Edinburgh-Genome-Foundry/Edinburgh-Genome-Foundry.github.io/master/static/imgs/logos/egf-codon-horizontal.png" src="https://raw.githubusercontent.com/Edinburgh-Genome-Foundry/Edinburgh-Genome-Foundry.github.io/master/static/imgs/logos/egf-codon-horizontal.png" /></a>
<p>Topkappy is part of the <a class="reference external" href="https://edinburgh-genome-foundry.github.io/">EGF Codons</a> synthetic biology software suite for DNA design, manufacturing and validation.</p>
<div class="toctree-wrapper compound">
</div>
<div class="toctree-wrapper compound">
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ref.html" class="btn btn-neutral float-right" title="Topkappy - Reference manual" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2018, Zulko

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>